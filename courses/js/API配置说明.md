# API配置说明

## 概述

本系统支持通过AI API生成题目，同时提供模拟数据作为备用方案。当API密钥未配置或API调用失败时，系统会自动使用预设的模拟题目数据。

## API配置

### 1. 配置API密钥

在 `ExerciseGenerator.js` 文件中找到以下行：

```javascript
const apiKey = 'YOUR_API_KEY_HERE'; // 请替换为有效的API密钥
```

将 `YOUR_API_KEY_HERE` 替换为您的有效API密钥。

### 2. API服务商

当前配置使用的是豆包（Doubao）API：
- API地址：`https://ark.cn-beijing.volces.com/api/v3/chat/completions`
- 模型：`doubao-1-5-pro-256k-250115`

### 3. 获取API密钥

1. 访问豆包AI开放平台
2. 注册并登录账户
3. 创建应用并获取API密钥
4. 确保账户有足够的额度

## 模拟数据模式

### 自动启用条件

系统在以下情况下会自动使用模拟数据：
1. API密钥未配置（仍为 `YOUR_API_KEY_HERE`）
2. API密钥为空
3. API调用失败（网络错误、认证失败、CORS错误等）

### 模拟数据内容

系统为每个课程预设了示例题目：
- **操作系统**：页面置换算法相关题目
- **线性代数**：矩阵行列式计算题目
- **高等数学**：函数导数计算题目
- **概率论**：概率计算题目
- **离散数学**：进制转换题目
- **微分方程**：微分方程求解题目
- **复变函数**：复数模长计算题目

## 错误处理

### 常见错误及解决方案

1. **CORS错误**
   - 错误信息：`Access to fetch at '...' has been blocked by CORS policy`
   - 解决方案：系统会自动回退到模拟数据，无需手动处理

2. **认证错误（401）**
   - 错误信息：`401 (Unauthorized)`
   - 原因：API密钥无效或过期
   - 解决方案：检查并更新API密钥，或使用模拟数据模式

3. **网络错误**
   - 错误信息：`Failed to fetch`
   - 原因：网络连接问题或API服务不可用
   - 解决方案：系统会自动回退到模拟数据

## 开发和测试

### 强制使用模拟数据

在开发和测试阶段，可以通过以下方式强制使用模拟数据：
1. 保持API密钥为 `YOUR_API_KEY_HERE`
2. 或者将API密钥设置为空字符串

### 添加新的模拟题目

在 `ExerciseGenerator.js` 中的 `mockExercises` 对象中添加新的课程题目：

```javascript
const mockExercises = {
    // 现有题目...
    'new_course': '新课程的示例题目内容...'
};
```

## 生产环境部署

### 安全注意事项

1. **API密钥安全**：
   - 不要将API密钥提交到公共代码仓库
   - 考虑使用环境变量或配置文件管理API密钥
   - 定期轮换API密钥

2. **备用方案**：
   - 模拟数据确保系统在API不可用时仍能正常运行
   - 定期更新模拟数据以保持内容质量

### 监控和日志

系统会在控制台输出以下日志信息：
- `API密钥未配置，使用模拟数据`
- `模拟题目加载完成`
- `AI题目生成成功`
- `AI题目生成失败，使用模拟数据`

通过这些日志可以监控API的使用情况和系统状态。